---
import papers from "../data/papers.json";
import Layout from "../layouts/Layout.astro";
import { Picture } from "@astrojs/image/components";

const imageImports = import.meta.glob("../images/articles/*.png", {
  eager: true,
});
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>CYBERNOISE</title>
  </head>

  <body>
    <Layout>
      <div class="papers">
        {
          papers.map((paper) => {
            const imageKey = Object.keys(imageImports).find((image) => {
              return image.indexOf(paper?.id || "") !== -1 ? paper?.id : "";
            });

            if (imageKey === undefined) {
              return null;
            }

            const image = imageImports[imageKey].default;

            return (
              <a href={`/articles/${paper.slug}`} class="paper">
                <div class="container">
                  <h3>{paper.title}</h3>

                  <Picture
                    class="image"
                    src={image}
                    alt={paper?.prompt ?? ""}
                    title={paper?.prompt ?? ""}
                    sizes="(max-width: 375px) 335px, (max-width: 428px) 388px, 500px"
                    widths={[375, 428, 500, 700, 856, 1000]}
                    formats={["avif", "webp", "jpeg"]}
                  />
                </div>

                <p>{paper.summary}</p>
              </a>
            );
          })
        }
      </div>
    </Layout>
  </body>
</html>

<style>
  .papers {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 20px;
  }

  @media (max-width: 1100px) {
    .papers {
      grid-template-columns: 1fr 1fr;
    }
  }

  @media (max-width: 767px) {
    .papers {
      grid-template-columns: 1fr;
    }
  }

  .paper {
    display: grid;
    grid-template-rows: 300px 1fr;
  }

  .container {
    position: relative;
  }

  h3 {
    width: calc(100% - 60px);
    position: absolute;
    left: 20px;
    bottom: 20px;
    background: rgba(0, 0, 0, 0.75);
    padding: 10px;
    border: 1px solid teal;
  }

  a {
    text-decoration: none;
    display: block;
    transition: all 0.3s ease-in-out;
  }

  a:hover {
    transform: scale(1.01);
    box-shadow: 0 0px 20px 10px teal, inset 0 0px 20px 4px teal;
  }

  .image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border: 1px solid teal;
  }

  p {
    padding: 10px;
  }
</style>
